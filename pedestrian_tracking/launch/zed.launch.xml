<launch>

    <arg name="onboard" default="true" description="Is ZED onboard the dog? Options: true, false"/>
    <arg name="localize" default="false" description="Publish odom updates from ZED. Options: true, false"/>

    <!-- Launch ZED wrapper -->
    <include file="$(find-pkg-share zed_wrapper)/launch/zed_camera.launch.py">
      <arg name="camera_model" value="zed2i" />
      <arg name="publish_tf" value="$(var localize)" />
      <arg name="base_frame" value="zed_link" />
      <arg name="config_path" value="$(find-pkg-share pedestrian_tracking)/config/zed_config.yaml"/>
    </include>

    <!-- convert zed object message to a type that is easier to work with -->
    <node pkg="pedestrian_tracking" exec="convert_zed_ped">
    </node>

    <!-- connect zed frame to map frame if external.-->
    <!-- TODO there must be a better way to pass in this config -->
    <node pkg="tf2_ros" exec="static_transform_publisher" 
        args="--frame-id map
              --child-frame-id zed_link
              --x 0
              --y 0
              --z 0
              --roll 0
              --pitch 0
              --yaw 0" 
        if="$(eval '\'$(var onboard)\' == \'false\'')">
    </node>

    <!-- connect zed frame to odom frame if onboard -->
    <node pkg="tf2_ros" exec="static_transform_publisher" 
        args="--frame-id odom
              --child-frame-id zed_link
              --x 0
              --y 0
              --z 0
              --roll 0
              --pitch 0
              --yaw 0" 
        if="$(eval '\'$(var onboard)\' == \'true\'')">
    </node>

    <!-- "remap" zed odom topic to regular odom topic -->
    <node pkg="pedestrian_tracking" exec="odom_passthrough" if="$(eval '\'$(var localize)\' == \'true\'')">
    </node>

</launch>
